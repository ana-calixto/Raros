<div class="container">

  <div class="header">
    <div class="profile-pic">
      <%= cl_image_tag @user.photo.key, class: "avatar-xlarge" if @user.photo.attached? %>
    </div>

    <div class="display-name">
      <h1><%= @user.first_name %> <%= @user.last_name %></h1>
    </div>
  </div>

  <div class="content">

    <div class="info">
      <h4>Sobre mim</h4>
      <p> <%= @user.description %></p>
      <br>
      <p><i class="fas fa-birthday-cake"></i>  Idade: <%= @age  %></p>
      <p><i class="far fa-gem"></i>  Raridade: <%= @user.disease.name %></p>
        <% if @user != current_user %>
          <p class="btn btn-success btn-block"><i class="far fa-comments"></i> <%= link_to "Diga oi!", chatrooms_path(id: @user.id), method: :post %></p>
        <% end %>
        <% if @user == current_user %>
          <p class="btn btn-success btn-block"><%= link_to "Editar", edit_user_registration_path %></p>
        <% end %>
    </div>

    <div class="middle-col">

      <div class="follow">

        <span>Followers</span> <%= @user.followers.count %>

        <span>Following</span> <%= @user.following.count %>

      <% if user_signed_in? && current_user.id != @user.id %>
        <% if current_user.is_following?(@user.id) %>
          <span class="btn btn-success  btn-block"> <%= link_to "Unfollow", unfollow_path(@user.id), method: :post, remote: true %></span>
        <% else %>
          <span class="btn btn-success btn-block"><%= link_to "Follow", follow_path(@user.id), method: :post, remote: true %></span>
        <% end %>
        <% end %>
      </div>

      <div class="container-post">

      <% if @user == current_user %>
        <%= cl_image_tag @user.photo.key, class: "avatar-large pic-post" %>
        <span class= "post-create btn-block">
        <%= link_to "Criar um post", new_topic_path, data: {toggle: "modal", target: "#topicModalCenter"} %>
          <div class="modal fade" id="topicModalCenter" tabindex="-1" role="dialog">
            <div class="modal-dialog modal-dialog-centered" role="document">
              <div class="modal-content">
                <%= simple_form_for Topic.new, remote: true do |f| %>
                  <div class="modal-header">
                    <%= f.input :title, label: false, placeholder: "Post Title" %>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                      <span aria-hidden="true">&times;</span>
                    </button>
                  </div>
                  <div class="modal-body">
                    <%= f.input :content %>
                  </div>
                  <div class="modal-footer">
                    <%= f.submit "Post", class: "btn btn-primary btn-block" %>
                  </div>
                <% end %>
              </div>
            </div>
          </div>
        </span>          
      <% end %>

      </div>

      <div class="post-list">
        <h4>Últimos posts</h4>
          <% if @topics.count == 0 %>
            <span class="no-post"> Ops! Parece que <%= @user.first_name %> ainda não escreveu nada por aqui. </span>
          <% else %>
            <ul class="items">
            <% @topics.last(3).each do |topic| %>
            <li><%= cl_image_tag @user.photo.key, class: "avatar" %>
            <%= link_to topic.title, topic_path(topic) %></li>
            <% end %>
            </ul>
          <%end%>  
      </div>
    </div>
  </div>
</div>

